function Update-SectionProgress {

    if (-not $window -or -not $window.Dispatcher) { return }

    $window.Dispatcher.BeginInvoke([Action]{
        foreach ($sec in $script:allSections) {
            $total = ($sec.Items | Measure-Object).Count
            $done  = @($sec.Items | Where-Object { $_.IsChecked -eq $true }).Count
            $sec.Progress.Text = "Progress: $done / $total completed"
        }
    }, [System.Windows.Threading.DispatcherPriority]::ApplicationIdle) | Out-Null
}
