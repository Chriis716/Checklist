function Update-SectionProgress {
    $window.Dispatcher.Invoke([Action]{
        foreach ($sec in $script:allSections) {
            $total = ($sec.Items | Measure-Object).Count
            $done  = @($sec.Items | Where-Object { $_.IsChecked -eq $true }).Count
            $sec.Progress.Text = "Progress: $done / $total completed"
        }
    }, [System.Windows.Threading.DispatcherPriority]::Background) | Out-Null
}
