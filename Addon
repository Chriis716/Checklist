function Update-SectionProgress {
    foreach ($sec in $script:allSections) {

        # Count total items robustly
        $total = ($sec.Items | Measure-Object).Count

        # Count completed items robustly (force array with @() so .Count always works)
        $done  = @($sec.Items | Where-Object { $_.IsChecked }).Count

        $sec.Progress.Text = "Progress: $done / $total completed"
    }
}
