function Test-IsAdmin {
    try {
        $wi = [Security.Principal.WindowsIdentity]::GetCurrent()
        $wp = New-Object Security.Principal.WindowsPrincipal($wi)

        # 1) Keep local Administrator check
        if ($wp.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) { 
            return $true 
        }

        # 2) Explicit user whitelist (DOMAIN\username format)
        $AdminUsers = @(
            'VHA\jsmith'
            'VHA\adoe'
            'VHA\mbrown'
            'VHA\csivi'
        )

        $currentUser = $wi.Name

        if ($AdminUsers -contains $currentUser) {
            return $true
        }

        return $false
    }
    catch {
        return $false
    }
}
