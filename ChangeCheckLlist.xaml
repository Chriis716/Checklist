<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Change Checklist" Height="760" Width="1120"
        WindowStartupLocation="CenterScreen"
        Background="#0F1218" Foreground="#FFFFFF">

  <Window.Resources>

    <Style TargetType="TextBlock">
      <Setter Property="TextWrapping" Value="Wrap"/>
      <Setter Property="Foreground" Value="#FFFFFF"/>
    </Style>

    <Style TargetType="CheckBox">
      <Setter Property="Foreground" Value="#FFFFFF"/>
    </Style>

    <Style TargetType="TextBox">
      <Setter Property="Foreground" Value="#FFFFFF"/>
      <Setter Property="CaretBrush" Value="#FFFFFF"/>
    </Style>

    <Style x:Key="PillButton" TargetType="Button">
      <Setter Property="Padding" Value="12,7"/>
      <Setter Property="Margin" Value="0,0,10,0"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="Foreground" Value="#FFFFFF"/>
      <Setter Property="Background" Value="#1B2332"/>
      <Setter Property="BorderBrush" Value="#2A3850"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="Cursor" Value="Hand"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <Border Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    CornerRadius="14">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
      <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="Background" Value="#22304A"/>
        </Trigger>
        <Trigger Property="IsEnabled" Value="False">
          <Setter Property="Opacity" Value="0.55"/>
        </Trigger>
      </Style.Triggers>
    </Style>

    <DataTemplate x:Key="ChecklistItemTemplate">
      <Border Margin="0,0,0,10" Padding="12"
              Background="#121927" BorderBrush="#25324A" BorderThickness="1"
              CornerRadius="14">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="34"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="280"/>
          </Grid.ColumnDefinitions>

          <CheckBox Grid.Column="0"
                    VerticalAlignment="Top"
                    IsChecked="{Binding IsChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    Margin="2,2,0,0"/>

          <StackPanel Grid.Column="1" Margin="6,0,12,0">
            <TextBlock FontSize="14" FontWeight="SemiBold" Text="{Binding Text}" Foreground="#FFFFFF"/>

            <TextBlock x:Name="LinkBlock" Margin="0,6,0,0" FontSize="12" Foreground="#85B6FF">
              <Hyperlink NavigateUri="{Binding LinkUrl}">
                <Run Text="{Binding LinkText}"/>
              </Hyperlink>
            </TextBlock>
          </StackPanel>

          <StackPanel Grid.Column="2">
            <TextBlock FontSize="12" Foreground="#AAB7D3" Text="Notes" Margin="0,0,0,6"/>
            <TextBox Text="{Binding Notes, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     MinHeight="54"
                     Background="#0D1422"
                     Foreground="#FFFFFF"
                     CaretBrush="#FFFFFF"
                     BorderBrush="#2A3850"
                     BorderThickness="1"
                     Padding="10"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     VerticalScrollBarVisibility="Auto"/>
            <TextBlock Margin="0,8,0,0" FontSize="11" Foreground="#8FA1C2"
                       Text="{Binding CheckedLabel}"/>
          </StackPanel>
        </Grid>
      </Border>
      <DataTemplate.Triggers>
        <DataTrigger Binding="{Binding HasLink}" Value="False">
          <Setter TargetName="LinkBlock" Property="Visibility" Value="Collapsed"/>
        </DataTrigger>
      </DataTemplate.Triggers>
    </DataTemplate>

  </Window.Resources>

  <DockPanel LastChildFill="True" Margin="18">

    <!-- Header -->
    <Border DockPanel.Dock="Top" Padding="18" CornerRadius="18"
            Background="#121927" BorderBrush="#25324A" BorderThickness="1">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <StackPanel>
          <TextBlock x:Name="TxtTitle" FontSize="22" FontWeight="ExtraBold" Text="Change Checklist" Foreground="#FFFFFF"/>
          <TextBlock Margin="0,6,0,0" Foreground="#AAB7D3" FontSize="12"
                     Text="Enter ChangeID, load/save progress automatically, and open the change record link."/>
        </StackPanel>

        <!-- ADMIN ONLY PANEL (hidden for users) -->
        <StackPanel x:Name="AdminPanel" Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
          <Button x:Name="BtnEditDefinition" Style="{StaticResource PillButton}" Content="Edit Template (JSON)"/>
          <Button x:Name="BtnOpenState" Style="{StaticResource PillButton}" Content="Open Saved State"/>
        </StackPanel>
      </Grid>
    </Border>

    <!-- ChangeID Bar -->
    <Border DockPanel.Dock="Top" Margin="0,14,0,0" Padding="14" CornerRadius="18"
            Background="#0C111B" BorderBrush="#25324A" BorderThickness="1">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="320"/>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <TextBlock VerticalAlignment="Center" FontWeight="SemiBold" Text="ChangeID:" Margin="0,0,10,0" Foreground="#FFFFFF"/>
        <TextBox x:Name="TxtChangeId"
                 Grid.Column="1"
                 Background="#0D1422"
                 Foreground="#FFFFFF"
                 CaretBrush="#FFFFFF"
                 BorderBrush="#2A3850"
                 BorderThickness="1"
                 Padding="10"
                 FontWeight="SemiBold"/>

        <Button x:Name="BtnLoad" Grid.Column="2" Style="{StaticResource PillButton}" Content="Load"/>
        <Button x:Name="BtnSave" Grid.Column="3" Style="{StaticResource PillButton}" Content="Save"/>
        <Button x:Name="BtnOpenCR" Grid.Column="4" Style="{StaticResource PillButton}" Content="Open Change Request"/>

        <TextBlock x:Name="TxtStatus" Grid.Column="5" VerticalAlignment="Center"
                   Foreground="#AAB7D3" FontSize="12" Text="Ready"/>
      </Grid>
    </Border>

    <!-- Single page content -->
    <Border Margin="0,14,0,0" Padding="14" CornerRadius="18"
            Background="#0C111B" BorderBrush="#25324A" BorderThickness="1">
      <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <StackPanel x:Name="ChecklistHost" Margin="0,4,0,0"/>
      </ScrollViewer>
    </Border>

  </DockPanel>
</Window>
